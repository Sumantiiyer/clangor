<body>
<textarea id="output" cols="100" rows="35"></textarea>
<script>
var Module = {
  print: (function() {
    var element = document.getElementById('output');
    element.value = ''; // clear browser cache
    return function(text) {
      text = Array.prototype.slice.call(arguments).join(' ');
      // These replacements are necessary if you render to raw HTML
      //text = text.replace(/&/g, "&amp;");
      //text = text.replace(/</g, "&lt;");
      //text = text.replace(/>/g, "&gt;");
      //text = text.replace('\n', '<br>', 'g');
      element.value += text + "\n";
      element.scrollTop = 99999; // focus on bottom
    };
  })(),
  printErr: function(x) {
    Module.print(x);
  },

  arguments: '-cc1 -triple i386-pc-linux-gnu -S -disable-free -disable-llvm-verifier -main-file-name input.cpp -mrelocation-model static -mdisable-fp-elim -fmath-errno -masm-verbose -mconstructor-aliases -target-cpu pentium4 -target-linker-version 2.22 -momit-leaf-frame-pointer -coverage-file /tmp/input.s -resource-dir /home/alon/Dev/clang+llvm-3.2-x86-linux-ubuntu-12.04/bin/../lib/clang/3.2 -fdebug-compilation-dir /tmp -ferror-limit 19 -fmessage-length 205 -mstackrealign -fobjc-runtime=gcc -fdiagnostics-show-option -fcolor-diagnostics -o input.s -x cpp-output input.cpp'.split(' '),

    //[
    //  '-ccc-echo',
    //  '-ccc-print-phases',
    //  '-c', '-x', 'cpp-output', 'input.cpp'
    //],

  preRun: function() {
    FS.createDataFile('/', 'input.cpp', intArrayFromString('void puts(const char *); int main() { puts("hi!"); return 0; }'), true, true);
  },
  postRun: function() {
    Module.print('Data: ' + intArrayToString(FS.analyzePath('input.s').object.contents));
  },
};
</script>
<script src="clang.js"></script>
</body>

